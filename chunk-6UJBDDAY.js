import{a as j}from"./chunk-UUCXUX5D.js";import"./chunk-HK7VWWZT.js";import{a as V,h as q,i as k,l as U,m as $}from"./chunk-EIVXGRUR.js";import{b as N,f as O,g as A,j as D,m as Q,n as L,p as G,q as z,r as R}from"./chunk-FRCXSWTE.js";import{_ as H,ca as I}from"./chunk-SDSHYV7S.js";import"./chunk-H7BDRFGO.js";import{$a as S,$b as p,$c as w,Aa as g,Gb as h,Hb as v,Ib as s,Jb as l,Kb as c,Ob as y,Rb as b,Tb as C,Xb as T,Yb as E,Zb as B,_a as _,bc as M,cb as a,db as f,ec as x,qa as F,xb as m,za as d}from"./chunk-FIIJ44BK.js";var J=["signInNgForm"];function K(r,o){return this.trackByFn(r,o.slice(0,10))}function W(r,o){if(r&1&&c(0,"img",11),r&2){let u=o.$implicit;m("src","data:image/png;base64, "+u,S)}}function X(r,o){if(r&1){let u=y();s(0,"button",14),b("click",function(){let t=d(u).$implicit,e=C();return g(e.askBySugest(t))}),p(1),l()}if(r&2){let u=o.$implicit;m("color","secondary"),a(),M(" ",u," ")}}var P=(()=>{let o=class o{constructor(i,t){this._aiService=i,this._formBuilder=t,this.overviewData="",this.answer="",this.suggestion=[],this.images=[]}ngOnInit(){this.initForm(),this.getOverview()}initForm(){this.chatbotForm=this._formBuilder.group({query:[""]})}getOverview1(){let i={action:"overview",user_id:"E2",list_retrievers:[{collection_name:"E2_CHATBOTV2_1"}]};this._aiService.chatbotUnified(i).subscribe(t=>{console.log(t)},t=>{console.log(t)})}getOverview(){}ask(){let t={action:"chatbot",user_id:"E2",query:this.chatbotForm.controls.query.value,history_id:"E2_CHATBOTV2_2_HST",list_retrievers:[{collection_name:"E2_CHATBOTV2_2"}],num_docs:3,num_top_docs:5,mode:1};this._aiService.makeQuestion(t).subscribe({next:e=>{e.type===w.DownloadProgress?this.answer=e.partialText+"\u2026":e.type===w.Response&&(this.answer=e.body,this.addSuggestion(this.answer),this.addImage(this.answer))},error:()=>{console.log("event.type")}})}addSuggestion(i){let e={action:"get_suggestions",user_id:"E2",query:this.chatbotForm.controls.query.value,list_retrievers:[{collection_name:"E2_CHATBOTV2_2"}],answer:i};this._aiService.getSuggestion(e).subscribe(n=>{console.log(n),this.suggestion=n.data},n=>{console.log(n)})}addImage(i){let t={action:"get_images",user_id:"E2",list_retrievers:[{collection_name:"E2_CHATBOTV2_2"}],answer:i};this._aiService.getImage(t).subscribe(e=>{console.log(e),this.images=e.data},e=>{console.log(e)})}askBySugest(i){this.chatbotForm.controls.query.setValue(i),this.suggestion=[],this.answer="",this.ask()}trackByFn(i,t){return t.id||i}};o.\u0275fac=function(t){return new(t||o)(f(j),f(G))},o.\u0275cmp=F({type:o,selectors:[["example"]],viewQuery:function(t,e){if(t&1&&T(J,5),t&2){let n;E(n=B())&&(e.chatbotNgForm=n.first)}},standalone:!0,features:[x],decls:19,vars:4,consts:[["chatbotNgForm","ngForm"],[1,"flex","min-w-0","flex-auto","flex-col"],[1,"flex-auto","p-6","sm:p-10"],[1,"h-400","max-h-400","min-h-400","rounded-2xl","border-2","border-dashed","border-gray-300"],["id","overview",3,"innerHTML"],[3,"ngSubmit","formGroup"],[1,"w-full"],["id","query","matInput","",3,"formControlName"],["type","submit"],["id","answer",3,"innerHTML"],["id","image"],["alt","",3,"src"],["id","suggestion"],["mat-flat-button","",1,"fuse-mat-button-large","mt-6","w-full",3,"color"],["mat-flat-button","",1,"fuse-mat-button-large","mt-6","w-full",3,"click","color"]],template:function(t,e){if(t&1){let n=y();s(0,"div",1)(1,"div",2)(2,"div",3),c(3,"div",4),s(4,"form",5,0),b("ngSubmit",function(){return d(n),g(e.ask())}),s(6,"mat-form-field",6)(7,"mat-label"),p(8,"Question"),l(),c(9,"input",7),s(10,"button",8),p(11,"send"),l()()(),c(12,"div",9),s(13,"div",10),h(14,W,1,1,"img",11,K,!0),l(),s(16,"div",12),h(17,X,2,2,"button",13,e.trackByFn,!0),l()()()()}t&2&&(a(3),m("innerHTML",e.overviewData,_),a(),m("formGroup",e.chatbotForm),a(5),m("formControlName","query"),a(3),m("innerHTML",e.answer,_),a(2),v(e.images),a(3),v(e.suggestion))},dependencies:[z,D,N,O,A,R,Q,L,k,q,V,$,U,I,H],encapsulation:2});let r=o;return r})();var pe=[{path:"",component:P}];export{pe as default};
